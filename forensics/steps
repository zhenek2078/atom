1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–ü–µ—Ä–µ–¥ –∞–Ω–∞–ª–∏–∑–æ–º –º–æ–Ω—Ç–∏—Ä—É–π –æ–±—Ä–∞–∑—ã –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Å—Ä–µ–¥–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ –∏–ª–∏ forensic workstation).

üîπ Windows: –ò—Å–ø–æ–ª—å–∑—É–π FTK Imager –∏–ª–∏ Autopsy –¥–ª—è –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—Ä–∞–∑–∞ –≤ —Ä–µ–∂–∏–º–µ "—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ".
üîπ Linux: –ò—Å–ø–æ–ª—å–∑—É–π mount, losetup, qemu-nbd, mmls –∏–ª–∏ Autopsy.

–ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–∑–∞
sudo losetup -Pf disk_image.raw
sudo mount -o ro /dev/loop0p1 /mnt/windows  # –¥–ª—è Windows-—Ä–∞–∑–¥–µ–ª–∞
sudo mount -o ro /dev/loop0p1 /mnt/linux    # –¥–ª—è Linux-—Ä–∞–∑–¥–µ–ª–∞
–ò–ª–∏ —á–µ—Ä–µ–∑ qemu-nbd (–µ—Å–ª–∏ –æ–±—Ä–∞–∑ –≤ —Ñ–æ—Ä–º–∞—Ç–µ qcow2):
sudo modprobe nbd
sudo qemu-nbd --connect=/dev/nbd0 disk_image.qcow2
sudo mount -o ro /dev/nbd0p1 /mnt/windows
2. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
Windows:
# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∏—Å–∫–æ–≤ –∏ —Ä–∞–∑–¥–µ–ª–æ–≤
diskpart
list disk
list volume
–ê–Ω–∞–ª–∏–∑ MFT:
$logfile = "C:\Temp\$((Get-Date).ToString('yyyyMMddHHmmss'))_mft.csv"
Get-ForensicFileRecord | Export-Csv -Path $logfile -NoTypeInformation
üîπ –ê–Ω–∞–ª–∏–∑ USN Journal:
Get-ForensicUsnJrnl | Export-Csv -Path "C:\Temp\usn.csv" -NoTypeInformation

Linux:
lsblk  # –í—ã–≤–µ—Å—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∏—Å–∫–∞
df -h  # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã
–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ñ–∞–π–ª–æ–≤:
fls -r -m / /mnt/linux > files.txt  # –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –≤ –æ–±—Ä–∞–∑–µ
icat /mnt/linux/suspicious_file > extracted_file  # –ò–∑–≤–ª–µ—á—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª
3. –ê–Ω–∞–ª–∏–∑ –∂—É—Ä–Ω–∞–ª–æ–≤ —Å–æ–±—ã—Ç–∏–π
Windows (–∂—É—Ä–Ω–∞–ª—ã —Å–æ–±—ã—Ç–∏–π)
wevtutil qe Security /c:1000 /f:text > C:\Temp\security.log
wevtutil qe System /c:1000 /f:text > C:\Temp\system.log
wevtutil qe Application /c:1000 /f:text > C:\Temp\application.log
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å EventViewer –∏–ª–∏ Windows Log Parser.

Linux (–∂—É—Ä–Ω–∞–ª—ã —Å–æ–±—ã—Ç–∏–π)
cat /var/log/auth.log | grep "Failed password"  # –ê–Ω–∞–ª–∏–∑ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
cat /var/log/syslog | grep "sudo"               # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö sudo-–∫–æ–º–∞–Ω–¥
cat /var/log/bash_history                       # –ò—Å—Ç–æ—Ä–∏—è –∫–æ–º–∞–Ω–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. –ü–æ–∏—Å–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
Windows (—Ä–µ–µ—Å—Ç—Ä, –ø—Ä–æ—Ü–µ—Å—Å—ã, —Å–µ—Ä–≤–∏—Å—ã, –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫)
reg query "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run"  # –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫
Get-Process | Sort-Object CPU -Descending | Select-Object -First 10  # –¢–æ–ø-10 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
Get-WmiObject Win32_Service | Where-Object {$_.StartMode -eq "Auto"}  # –°–ª—É–∂–±—ã

Linux (–∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫, rootkits)
ps aux --sort=-%cpu | head -10  # –°–∞–º—ã–µ –Ω–∞–≥—Ä—É–∂–∞—é—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
ls -lah /etc/rc.local /etc/init.d/  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
chkrootkit  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä—É—Ç–∫–∏—Ç—ã (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ)
5. –ê–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
Windows (—Å–µ—Ç–µ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, DNS-–∑–∞–ø—Ä–æ—Å—ã)
netstat -ano | Sort-Object -Property State  # –°–µ—Ç–µ–≤—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
Get-DnsClientCache | Format-Table  # –ö—ç—à DNS-–∑–∞–ø—Ä–æ—Å–æ–≤
Get-WmiObject Win32_NetworkAdapterConfiguration | Where-Object { $_.IPAddress }  # –°–µ—Ç–µ–≤—ã–µ –∞–¥–∞–ø—Ç–µ—Ä—ã

Linux (—Å–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –∂—É—Ä–Ω–∞–ª –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞)
netstat -tulnp  # –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
cat /var/log/syslog | grep "iptables"  # –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–æ–º
cat /var/log/nginx/access.log  # –õ–æ–≥–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
6. –ê–Ω–∞–ª–∏–∑ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
Windows (–∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã, —Å–∫—Ä–∏–ø—Ç—ã, DLL)
Get-ChildItem -Path C:\Users\*\AppData\Local\Temp -Recurse -ErrorAction SilentlyContinue
Get-ChildItem -Path C:\Windows\Temp -Recurse -ErrorAction SilentlyContinue

Linux (–∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã, –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ)
find /mnt/linux -type f -name "*.sh" -o -name "*.py"  # –ü–æ–∏—Å–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤
find /mnt/linux -type f -perm /4000  # –ü–æ–∏—Å–∫ SUID-–±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤
find /mnt/linux -type f -newermt "2024-03-01"  # –§–∞–π–ª—ã, –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –ø–æ—Å–ª–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –¥–∞—Ç—ã
7. –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ (Timeline Analysis)
Windows
Get-ForensicTimeline -Path C:\Temp\timeline.csv

Linux
fls -o 2048 -m / /mnt/linux > timeline.txt

8. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å–ª–µ–¥–æ–≤ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
Windows (–±–ª–æ–∫–Ω–æ—Ç, —Ñ–∞–π–ª—ã, –¥–æ–∫—É–º–µ–Ω—Ç—ã)
Get-ChildItem "C:\Users\*\Recent" -Recurse  # –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ —Ñ–∞–π–ª—ã

Linux (bash history, cron, sudo)
cat /mnt/linux/root/.bash_history
cat /mnt/linux/var/spool/cron/crontabs/root
